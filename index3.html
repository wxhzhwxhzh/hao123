<!DOCTYPE html>
<html lang="en">



<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>WangXianSheng视频站</title>

    <!-- 装饰栏 开始 -->
    <style>
        body {

            background-color: #f3f3f5;
            text-align: center;



        }

        .juzhong {
            position: absolute;
            left: 10%;
            right: 10%;
        }



        h1 {
            color: #244981;
        }

        #randomButton {
            height: 50px;
            background-color: chocolate;
            border-radius: 1rem;
            /* 设置按钮的高度为50像素 */
        }

        .pics_content
        {
           width: 75%;
        }

    </style>

    <!-- 装饰栏  结束 -->




</head>







<body>

    <div class="juzhong">

        <h1>WangXianSheng视频站</h1>

        <!-- <img id="pic" src="img/logo.ico">
        <img id="pic2" src="img/logo.ico"> -->


        <div id="pics">  </div>



        
        <div id="dplayer"></div>
        <!-- <div> <img src="img/screenshot.webp">

        </div> -->
        <p style="color: red;">点击下面按钮刷新下一个视频</p>
        <button id="randomButton" style="min-width: 100px;"  onclick="updateRandomUrl()">刷新</button>

        <br/>
        <br/>

        <a id="raw_url" href='https://www.bi1ibili.com/m3u8/3/3025/index.m3u8'  target="_blank">访问原始网页</a>

        <div id="info">版权所有</div>





    </div>

    <!-- 脚本栏start -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dplayer/1.27.1/DPlayer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        var raw_url="https://heiliao385.pro/archives/2191.html";

        const dp = new DPlayer({
            container: document.getElementById('dplayer'),
            screenshot: true,
            logo: './img/logo.ico',
            video: {
                url: 'https://www.bi1ibili.com/m3u8/3/3025/index.m3u8',
                pic: './img/01.jpg',
                thumbnails: 'thumbnails.jpg',
            },
            subtitle: {
                url: 'webvtt.vtt',
            },
            danmaku: {
                id: 'demo',
                api: 'https://api.prprpr.me/dplayer/',
            },
        });


    </script>

    <script>
        // 更新随机URL
        function updateRandomUrl() {
            // 生成随机数字
            var num = generateRandomNumber();
            
            // 构建m3u8_url和pic_urls
            var m3u8_url = `https://www.bi1ibili.com/m3u8/${num[0]}/${num}/index.m3u8`;
            var new_raw_url = raw_url.replace("2191",num);

            var pic_urls = [
                `https://heiliao391.pro/files/image/${num[0]}/${num}/${num}-1.jpg`,
                `https://heiliao391.pro/files/image/${num[0]}/${num}/${num}-2.jpg`,
                `https://heiliao391.pro/files/image/${num[0]}/${num}/${num}-3.jpg`,
            ];
            
            // 更新按钮文本为m3u8_url
            var button = document.getElementById('randomButton');
            button.innerText = m3u8_url;

            // 插入图片
            insertImages(pic_urls);
            document.getElementById("raw_url").setAttribute("href",new_raw_url);
            document.getElementById("raw_url").innerText=new_raw_url;

            // 暂停视频播放，并切换视频源和封面图
            dp.pause();
            dp.switchVideo({
                url: m3u8_url,
                pic: './img/01.jpg'
            });
        }

        // 生成随机数字
        function generateRandomNumber() {
            var randomNumber = Math.floor(Math.random() * (3500 - 2000 + 1)) + 2000;
            return randomNumber.toString();
        }

        // 插入图片
        function insertImages(urls) {
            var div = document.getElementById("pics");
            div.innerHTML = "";

            urls.forEach(function(url) {
                var img = document.createElement("img");
                img.src = url;
                img.className="pics_content"
                                
                div.appendChild(img);
            });
        }
    </script>






    <script>
        // 获取所有 class 为 "dengbili" 的元素
        var elements = document.getElementsByClassName("dengbili");

        // 遍历每个符合条件的元素
        for (var i = 0; i < elements.length; i++) {
            var element = elements[i];
            element.style.width = "80%";
            var width = element.offsetWidth; // 获取元素的宽度
            element.style.height = width * 0.5 + "px"; // 设置高度为宽度的一半
        }



    </script>

    <!-- 脚本栏end     -->

</body>

</html>